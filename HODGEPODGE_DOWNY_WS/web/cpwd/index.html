<!DOCTYPE html>
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<title>Downy Hodgepodge - Random password</title>
	<script src="http://resources.downy.ws/jquery/jquery-1.10.1.min.js"></script>
	<style>
		div{margin-bottom:10px;}
	</style>
</head>
<body>
<div>
	<input type="checkbox" checked="checked" />数字
	<input type="checkbox" checked="checked" />小写字母
	<input type="checkbox" checked="checked" />大写字母
	<input type="checkbox" checked="checked" />符号
</div>
<div>
	<input type="text" style="width:30px;" />
	<input type="button" value="生成" />
</div>
<div>密码：<span></span></div>
<script type="text/javascript">
	var CHARS = [
		"1234567890", 
		"abcdefghijklmnopqrstuvwxyz",
		"ABCDEFGHIJKLMNOPQRSTUVWXYZ",
		"`~!@#$%^&*()-=_+[]{}\|;',./:\"<>?"
	];
	$("input[type=button]").click(function(){
		var hit = [false, false, false, false];
		var length = $("input[type=text]").val();
		$("input[type=checkbox]").each(function(index){
			if(!$(this).is(":checked")){
				hit[index] = true;
			}
		});
		if(
			length <= 0 
			|| isNaN(length)
			|| (hit[0] && hit[1] && hit[2] && hit[3])
			|| (length - (hit[0] ? 0 : 1) - (hit[1] ? 0 : 1) - (hit[2] ? 0 : 1) - (hit[3] ? 0 : 1)) < 0
		){
			$("span").text("凸(- -)凸");
			return;
		}

		var pwd = "", type = null, l = [
			hit[0] ? 0 : CHARS[0].length, 
			hit[1] ? 0 : CHARS[1].length, 
			hit[2] ? 0 : CHARS[2].length, 
			hit[3] ? 0 : CHARS[3].length
		];
		for(var i = 0; i < length; i++){
			type = parseInt(Math.random() * 4);
			if(l[type] == 0){
				i--;
			}else{
				index = parseInt(Math.random() * l[type]);
				hit[type] = true;
				pwd += CHARS[type][index];
			}
		}

		if(hit[0] && hit[1] && hit[2] && hit[3]){
			$("span").text(pwd);
		}else{
			$(this).click();
		}
	});
</script>
</body>
</html>